<div class="mission-container">
  
  <div class="search-card">
    <div class="header-title">
      <span class="icon">üöÄ</span> Mission Control
    </div>
    
    <div class="search-form">
      <div class="input-group">
        <input type="text" 
               [ngModel]="filter.name" 
               (ngModelChange)="filter.name = $event; onSubmit()" 
               placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à..." 
               class="form-control">
      </div>
      
      <div class="input-group">
        <select [ngModel]="filter.status" 
                (ngModelChange)="filter.status = $event; onSubmit()"
                class="form-control status-select">
          <option value="">-- ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --</option>
          <option value="Open">üîµ Open</option>
          <option value="InProgress">üü° In Progress</option>
          <option value="Completed">üü¢ Completed</option>
          <option value="Closed">üî¥ Closed</option>
        </select>
      </div>

      <button (click)="onSubmit()" class="btn-search">
        ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
      </button>
    </div>
  </div>

  <div class="results-card">
    <div class="table-responsive">
      <table class="mission-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>MISSION NAME</th>
            <th>DESCRIPTION</th>
            <th>CHIEF ID</th>
            <th>CREW</th>
            <th>STATUS</th>
            <th>CREATED AT</th>
            <th>ACTION</th>
          </tr>
        </thead>
        <tbody>
          @for (mission of missions; track mission.id) {
            <tr>
              <td class="text-muted">#{{ mission.id }}</td>
              <td class="fw-bold">{{ mission.name }}</td>
              <td class="text-desc">{{ mission.description || '-' }}</td>
              <td><div class="chief-badge">üëÆ {{ mission.chief_id }}</div></td>
              <td>{{ mission.crew_count }} / 3</td>
              <td>
                <span class="status-badge" [ngClass]="{'open': mission.status === 'Open'}">
                  {{ mission.status }}
                </span>
              </td>
              <td class="text-date">{{ mission.created_at | date:'dd/MM/yyyy HH:mm' }}</td>
              <td>
                @if (mission.crew_count >= 3) {
                   <button class="btn-join disabled" disabled>Full</button>
                } @else {
                   <button class="btn-join" (click)="joinMission(mission.id)">Join</button>
                }
              </td>
            </tr>
          } @empty {
            <tr><td colspan="8" class="no-data">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à</td></tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</div>